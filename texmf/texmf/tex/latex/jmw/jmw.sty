% Much of this is copied from Evan Chen.

\ProvidesPackage{jmw}

\newif\ifjmwsetup\jmwsetupfalse

\newif\ifjmwmdfthm\jmwmdfthmfalse

\newif\ifjmwcolorlinks\jmwcolorlinksfalse
\DeclareOption{sexy}{\jmwsetuptrue\jmwmdfthmtrue\jmwcolorlinkstrue}
\ProcessOptions\relax

\usepackage{amsmath}

\usepackage{amssymb}

\usepackage{amsthm}

\usepackage{mathrsfs}

\usepackage[usenames,svgnames,dvipsnames]{xcolor}

\ifjmwcolorlinks
  \usepackage[colorlinks=true]{hyperref}
  \hypersetup{urlcolor=RubineRed,linkcolor=RoyalBlue,citecolor=ForestGreen}
\else
  \usepackage{hyperref}
\fi

\usepackage{graphicx}

\usepackage{siunitx}

\usepackage{dsfont} % sexy double-struck chars

\usepackage{tikz}

\usepackage{pgfplots}

\usepackage{mathtools}

\usepackage{thmtools}

\usepackage{natbib}

\usepackage{thm-restate}

\usepackage{stmaryrd}

\usepackage{tikz-cd}

\usepackage{centernot}

\foreach \x in {A,...,Z}{%
\expandafter\xdef\csname ds\x\endcsname{\noexpand\ensuremath{\noexpand\mathds{\x}}}
\expandafter\xdef\csname cal\x\endcsname{\noexpand\ensuremath{\noexpand\mathcal{\x}}}
\expandafter\xdef\csname frak\x\endcsname{\noexpand\ensuremath{\noexpand\mathfrak{\x}}}
\expandafter\xdef\csname scr\x\endcsname{\noexpand\ensuremath{\noexpand\mathscr{\x}}}
}

\newcommand{\FF}{\dsF}
\newcommand{\PP}{\dsP}
\newcommand{\EE}{\dsE}
\newcommand{\eps}{\ensuremath{\epsilon}}
\newcommand{\dt}{\ensuremath{\delta}}
\newcommand{\del}{\partial} 
\newcommand{\cbrt}{\sqrt[3]} % "cube root"
\renewcommand{\phi}{\varphi}
\let\d\relax
\newcommand{\d}{\ensuremath{\mathrm{d}}}

\newcommand{\NN}{\dsN}
\newcommand{\ZZ}{\dsZ}
\newcommand{\QQ}{\dsQ}
\newcommand{\RR}{\dsR}
\newcommand{\CC}{\dsC} 
\newcommand{\HH}{\dsH}

\newcommand{\Unif}{\ensuremath{\textsc{Unif}}} 
\newcommand{\Ber}{\ensuremath{\textsc{Ber}}}
\newcommand{\Geom}{\ensuremath{\textsc{Geom}}} 
\newcommand{\Exp}{\ensuremath{\textsc{Exp}}} 
\newcommand{\Cauchy}{\ensuremath{\textsc{Cauchy}}}
\newcommand{\Pois}{\ensuremath{\textsc{Pois}}}
\newcommand{\Gauss}{\calN}
\newcommand{\Binom}{\ensuremath{\textsc{Binom}}}

\DeclareMathOperator{\GL}{GL} 
\DeclareMathOperator{\SL}{SL} 
\DeclareMathOperator{\GO}{GO} 
\DeclareMathOperator{\SO}{SO} 
\DeclareMathOperator{\GU}{GU} 
\DeclareMathOperator{\SU}{SU}

\newcommand{\BigO}{\mathcal{O}} 
\newcommand{\LittleO}{\mathcal{o}} 
\newcommand{\BigOm}{\Omega}

\DeclareMathOperator{\fl}{fl}

\newcommand{\KL}[2]{\ensuremath{D_{KL}\left(#1, #2\right)}}

\newcommand{\defeq}{\ensuremath{\stackrel{\mathrm{def}}{=}}}

\newcommand{\mailto}[1]{\href{mailto:#1}{\texttt{#1}}}

\newcommand{\norm}[1]{\ensuremath{\left\lVert #1\right\rVert}}

\newcommand{\abs}[1]{\ensuremath{\left\lvert #1\right\rvert}}

\let\floor\relax
\DeclarePairedDelimiterX\floor[1]\lfloor\rfloor{
  #1
}
\let\ceil\relax
\DeclarePairedDelimiterX\ceil[1]\lceil\rceil{
  #1
}

\renewcommand{\SS}{\ensuremath{\mathds{S}}} % sphere

\newcommand{\ind}[1]{\ensuremath{\mathbf{1}_{#1}}} % indicator func
\newcommand{\probto}{\xrightarrow{p}}
\newcommand{\asto}{\xrightarrow{a.s.}}
\newcommand{\distto}{\xrightarrow{d}}
\newcommand{\Law}[1]{\ensuremath{\mathcal{L}_{#1}}}

\let\Pr\relax
\DeclarePairedDelimiterXPP
  \Pr
  [1]
  {\PP} % pre code
  {[}
  {]}
  {} % post code
  {#1}

\let\Var\relax
\DeclarePairedDelimiterXPP
  \Var
  [1]
  {\text{Var}} % pre code
  {[}
  {]}
  {} % post code
  {#1}

\let\Ev\relax
\DeclarePairedDelimiterXPP
  \Ev
  [1]
  {\EE} % pre code
  {[}
  {]}
  {} % post code
  {#1}

\newcommand{\Card}[1]{\ensuremath{\abs{#1}}}
% \newcommand{\card}[1]{\ensuremath{\abs{#1}}}

\newcommand{\ip}[2]{\ensuremath{\left\langle #1, #2\right\rangle}}

\DeclareMathOperator{\Tr}{Tr} % "Trace"
\DeclareMathOperator{\D}{D} % Jacobian

\newcommand{\bvec}[1]{\ensuremath{\mathbf{#1}}} 
\newcommand{\bmat}[1]{\ensuremath{\mathbf{#1}}}

\DeclareMathOperator{\Cov}{Cov}

\newcommand{\Enc}{\ensuremath{\textsc{Enc}}}
\newcommand{\Dec}{\ensuremath{\textsc{Dec}}}
\newcommand{\Gen}{\ensuremath{\textsc{Gen}}}
\newcommand{\Sign}{\ensuremath{\textsc{Sign}}}
\newcommand{\Verify}{\ensuremath{\textsc{Verify}}}
\newcommand{\MAC}{\ensuremath{\textsc{MAC}}}
\newcommand{\Comm}{\ensuremath{\textsc{Comm}}}
\newcommand{\pk}{\ensuremath{\textsf{pk}}}
\newcommand{\sk}{\ensuremath{\textsf{sk}}}

\newcommand{\from}{\leftarrow}

\DeclareMathOperator{\Dom}{Dom} 
\DeclareMathOperator{\Cod}{Cod}

\let\bar\relax
\newcommand{\bar}[1]{\overline{#1}}

\newcommand{\Vect}[1]{#1\text{-\textbf{Vect}}}
\newcommand{\Mod}[1]{#1\text{-\textbf{Mod}}}
\newcommand{\FinVect}[1]{#1\text{-\textbf{FinVect}}}
\let\Top\relax
\newcommand{\Top}{\mathbf{Top}} % topological spaces
\newcommand{\Man}{\mathbf{Man}} % smooth manifolds
\newcommand{\Set}{\mathbf{Set}} 
\newcommand{\Grp}{\mathbf{Grp}} 
\newcommand{\Ab}{\mathbf{Ab}} 
\newcommand{\Cat}{\mathbf{Cat}} 
\newcommand{\Alg}[1]{#1\text{-\textbf{Alg}}} % algebra over a field
\newcommand{\Meas}{\mathbf{Meas}} 
\newcommand{\CRing}{\mathbf{CRing}}
\newcommand{\Topp}{\mathbf{Top_\bullet}} % pointed topological spaces

\newcommand{\monoto}[1]{\xhookrightarrow{#1}}
% there is no \xtwoheadrightarrow
% from https://tex.stackexchange.com/a/260563/171101
\newcommand{\xtwoheadrightarrow}[2][]{%
  \xrightarrow[#1]{#2}\mathrel{\mkern-14mu}\rightarrow
}
\newcommand{\epito}[1]{\xtwoheadrightarrow{#1}}
\newcommand{\morto}[1]{\xrightarrow{#1}}
\newcommand{\isoto}[1]{\stackrel{#1}{\xrightarrow{\sim}}}
\newcommand{\To}{\Rightarrow}

\newcommand{\partto}{\nrightarrow}

\newcommand{\downto}{\downarrow}
\newcommand{\upto}{\uparrow}

\newcommand{\Ob}[1]{\ensuremath{\text{Ob}(#1)}}
\newcommand{\Hom}{\ensuremath{\text{Hom}}}
\newcommand{\Nat}{\ensuremath{\text{Nat}}}

\newcommand{\tensor}{\otimes}

\DeclareMathOperator{\Diff}{Diff} 
\DeclareMathOperator{\Aut}{Aut}

\newcommand{\negl}{\textsf{negl}}
\newcommand{\len}{\textsf{len}}
\newcommand{\poly}{\textsf{poly}} % means "polynomial in"
\let\eval\relax
\newcommand{\eval}{\textsf{eval}}

\newcommand{\iso}{\sim}

\let\Det\relax
\DeclarePairedDelimiterXPP
  \Det
  [1]
  {\det} % pre code
  {(}
  {)}
  {} % post code
  {#1}

\let\Jacobian\relax
\newcommand{\Jacobian}[1]{\ensuremath{D#1}}

\let\concat\relax
\newcommand{\concat}{\mathbin{\|}}

\newcommand{\compind}{\approx_c}
\newcommand{\distas}{\sim}
\let\Rv\relax
\DeclarePairedDelimiterXPP
  \Rv
  [1]
  {} % pre code
  {[}
  {]}
  {} % post code
  {#1}
\newcommand{\IPS}[2]{\langle#1, #2\rangle}

% copied from http://texdoc.net/texmf-dist/doc/latex/mathtools/mathtools.pdf
\newcommand\GivenSymbol[1][]{%
  \nonscript\:#1\vert\allowbreak\nonscript\:\mathopen{}
}
\let\given\relax
\newcommand\given{\GivenSymbol[\delimsize]}
\DeclarePairedDelimiterX\Paren[1](){
  #1
}

\newcommand{\id}{\mathrm{id}}

\DeclarePairedDelimiterX\Legendre[2](){
  \frac{#1}{#2}
}
\DeclarePairedDelimiterX\Jacobi[2](){
  \frac{#1}{#2}
}

\newcommand{\DD}{\dsD}

\let\implies\relax
\newcommand{\implies}{\Longrightarrow}
\let\revimplies\relax
\newcommand{\revimplies}{\Longleftarrow}
\let\notimplies\relax
\newcommand{\notimplies}{\centernot\Longrightarrow}

\DeclareMathOperator{\SeqCl}{SeqCl}

\let\of\relax
\newcommand{\of}{\circ}
\let\then\relax
\newcommand{\then}{\fatsemi }

\let\Image\relax
\DeclareMathOperator{\Image}{Im}

\let\Span\relax
\DeclareMathOperator{\Span}{Span}
\let\Dim\relax
\DeclareMathOperator{\Dim}{Dim}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand\indep{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}

\newcommand{\disteq}{\ensuremath{\overset{\text{d}}{=}}}

\renewcommand\th{^{\text{\normalfont{th}}}} % Harry likes this
\newcommand{\degrees}{^\circ} % "degrees"

\setlength{\parskip}{0.5\baselineskip}
\setlength{\parindent}{0pt}

\ifjmwsetup
  \ifjmwmdfthm
    \usepackage[framemethod=TikZ]{mdframed}
    \mdfdefinestyle{mdfbluebox}{%
      roundcorner=10pt,
      linewidth=1pt,
      skipabove=12pt,
      innerbottommargin=9pt,
      skipbelow=2pt,
      linecolor=blue,
      nobreak=true,
      backgroundcolor=TealBlue!5,
    }
    \declaretheoremstyle[
    headfont=\sffamily\bfseries\color{MidnightBlue},
    mdframed={style=mdfbluebox},
    headpunct={\\[3pt]},
    postheadspace={0pt}
    ]{thmbluebox}
    
    \mdfdefinestyle{mdfgreenbox}{%
      roundcorner=10pt,
      linewidth=1pt,
      skipabove=12pt,
      innerbottommargin=9pt,
      skipbelow=2pt,
      linecolor=Green,
      nobreak=true,
      backgroundcolor=Green!5,
    }
    \declaretheoremstyle[
    headfont=\sffamily\bfseries\color{OliveGreen},
    mdframed={style=mdfgreenbox},
    headpunct={\\[3pt]},
    postheadspace={0pt}
    ]{thmgreenbox}
    
    \mdfdefinestyle{mdfredbox}{%
      roundcorner=10pt,
      linewidth=1pt,
      skipabove=12pt,
      innerbottommargin=9pt,
      skipbelow=2pt,
      linecolor=red,
      nobreak=true,
      backgroundcolor=Red!5,
    }
    \declaretheoremstyle[
    headfont=\sffamily\bfseries\color{Maroon},
    mdframed={style=mdfredbox},
    headpunct={\\[3pt]},
    postheadspace={0pt}
    ]{thmredbox}
    
    \mdfdefinestyle{mdfcyanbox}{%
      roundcorner=10pt,
      linewidth=1pt,
      skipabove=12pt,
      innerbottommargin=9pt,
      skipbelow=2pt,
      linecolor=cyan,
      nobreak=true,
      backgroundcolor=Cyan!5,
    }
    \declaretheoremstyle[
    headfont=\sffamily\bfseries\color{CornflowerBlue},
    mdframed={style=mdfcyanbox},
    headpunct={\\[3pt]},
    postheadspace={0pt}
    ]{thmcyanbox}
    
    \mdfdefinestyle{mdftanbox}{%
      linewidth=0.5pt,
      skipabove=12pt,
      frametitleaboveskip=5pt,
      frametitlebelowskip=0pt,
      skipbelow=2pt,
      frametitlefont=\bfseries,
      innertopmargin=4pt,
      innerbottommargin=8pt,
      nobreak=true,
      backgroundcolor=Salmon!5,
      linecolor=RawSienna,
    }
    \declaretheoremstyle[
    headfont=\bfseries\color{RawSienna},
    mdframed={style=mdftanbox},
    headpunct={\\[3pt]},
    postheadspace={0pt},
    ]{thmtanbox}
    
    \mdfdefinestyle{mdfblackbox}{%
      linewidth=0.8pt,
      skipabove=12pt,
      frametitleaboveskip=5pt,
      frametitlebelowskip=0pt,
      skipbelow=2pt,
      innertopmargin=4pt,
      innerbottommargin=8pt,
      nobreak=true,
      backgroundcolor=Black!5,
      linecolor=Black,
    }
    \declaretheoremstyle[
    headfont=\bfseries,
    mdframed={style=mdfblackbox},
    headpunct={\\[3pt]},
    postheadspace={0pt},
    ]{thmblackbox}
    
    % numbered
    \declaretheorem[style=thmbluebox,name=Theorem,numberwithin=section]{theorem}
    \declaretheorem[style=thmcyanbox,name=Conjecture,sibling=theorem]{conjecture}
    \declaretheorem[style=thmcyanbox,name=Pseudo-theorem,sibling=theorem]{pseudotheorem}
    \declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemma}
    \declaretheorem[style=thmbluebox,name=Corollary,sibling=theorem]{corollary}
    \declaretheorem[style=thmbluebox,name=Proposition,sibling=theorem]{proposition}
    \declaretheorem[style=thmgreenbox,name=Definition,sibling=theorem]{definition}
    \declaretheorem[style=thmcyanbox,name=Pseudo-definition,sibling=theorem]{pseudodefinition}
    \declaretheorem[style=thmredbox,name=Problem,sibling=theorem]{problem}
    \declaretheorem[style=thmtanbox,name=Example,sibling=theorem]{example}
    \declaretheorem[style=thmtanbox,name=Argument,sibling=theorem]{argument}
    \declaretheorem[style=thmtanbox,name=Remark,sibling=theorem]{remark}    
    \declaretheorem[style=thmblackbox,name=Idea,sibling=theorem]{idea}
    
    % numbered, no box
    \declaretheorem[name=Lemma,sibling=theorem]{lemma-nobox}
    
    % no number
    \declaretheorem[style=thmbluebox,name=Theorem,numbered=no]{theorem*}
    \declaretheorem[style=thmbluebox,name=Proposition,numbered=no]{proposition*}
    \declaretheorem[style=thmbluebox,name=Corollary,numbered=no]{corollary*}  
  \else
    \newtheorem{theorem}{Theorem}[section]
    \newtheorem{lemma}[theorem]{Lemma}
    \newtheorem{definition}[theorem]{Definition}
  \fi
\fi

\@ifundefined{KOMAClassName}
{}
{
  \setkomafont{author}{\Large\scshape}
  \setkomafont{date}{\Large\normalsize}
}

\newcommand{\pgfcauchypdf}[2]{(#2)/(pi*((#2)^2+(x-(#1))^2))}

\newcommand{\kora}{%
(\raisebox{0.5em}{\rotatebox{-45}{)}}$^{\circ}{\scriptscriptstyle\Box}^{\circ}$)\raisebox{0.5em}{\rotatebox{-45}{)}}\rotatebox{90}{)}\raisebox{0.5ex}{$\bot$}$\mkern-3.5mu-\mkern-3.5mu$\raisebox{0.5ex}{$\bot$}
}
